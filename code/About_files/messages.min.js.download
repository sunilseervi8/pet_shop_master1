define(['jquery','uiComponent','Magento_Customer/js/customer-data','underscore','jquery/jquery-storageapi'],function($,Component,customerData,_){'use strict';return Component.extend({defaults:{cookieMessages:[],messages:[],isHidden:false,selector:'.page.messages .messages'},initialize:function(){this._super();this.cookieMessages=$.cookieStorage.get('mage-messages');this.messages=customerData.get('messages').extend({disposableCustomerData:'messages'});if(!_.isEmpty(this.messages().messages)){customerData.set('messages',{});}
$.cookieStorage.set('mage-messages','');this.messages.subscribe(function(messages){if(messages.messages){if(messages.messages.length>0){setTimeout(function(){customerData.set('messages',{});},4500);}}});},initObservable:function(){this._super().observe('isHidden');return this;},isVisible:function(){return this.isHidden(!_.isEmpty(this.messages().messages)||!_.isEmpty(this.cookieMessages));}});});